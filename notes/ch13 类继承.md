## ç¬¬åä¸‰ç«  ç±»ç»§æ‰¿

é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸»è¦ç›®çš„ä¹‹ä¸€æ˜¯æä¾›å¯é‡ç”¨çš„ä»£ç ã€‚å¼€å‘æ–°é¡¹ç›®ï¼Œå°¤å…¶æ˜¯å½“é¡¹ç›®ååˆ†åºå¤§æ—¶ï¼Œé‡ç”¨ç»è¿‡æµ‹è¯•çš„ä»£ç æ¯”é‡æ–°ç¼–å†™ä»£ç è¦å¥½å¾—å¤šã€‚ä½¿ç”¨å·²æœ‰çš„ä»£ç å¯ä»¥èŠ‚çœæ—¶é—´ï¼Œç”±äºå·²æœ‰çš„ä»£ç å·²è¢«ä½¿ç”¨å’Œæµ‹è¯•è¿‡ï¼Œå› æ­¤æœ‰åŠ©äºé¿å…åœ¨ç¨‹åºä¸­å¼•å…¥é”™è¯¯ã€‚å¦å¤–ï¼Œå¿…é¡»è€ƒè™‘çš„ç»†èŠ‚è¶Šå°‘ï¼Œä¾¿è¶Šèƒ½ä¸“æ³¨äºç¨‹åºçš„æ•´ä½“ç­–ç•¥ã€‚

C++æä¾›äº†æ¯”ä¿®æ”¹ä»£ç æ›´å¥½çš„æ–¹æ³•æ¥æ‰©å±•å’Œä¿®æ”¹ç±»ã€‚è¿™ç§æ–¹æ³•å«ä½œç±»ç»§æ‰¿ï¼Œå®ƒèƒ½å¤Ÿä»å·²æœ‰çš„ç±»æ´¾ç”Ÿå‡ºæ–°çš„ç±»ï¼Œè€Œæ´¾ç”Ÿç±»ç»§æ‰¿äº†åŸæœ‰ç±»ï¼ˆç§°ä¸ºåŸºç±»ï¼‰çš„ç‰¹å¾ï¼ŒåŒ…æ‹¬æ–¹æ³•ã€‚

* å¯ä»¥åœ¨å·²æœ‰ç±»çš„åŸºç¡€ä¸Šæ·»åŠ åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œå¯¹äºæ•°ç»„ç±»ï¼Œå¯ä»¥æ·»åŠ æ•°å­¦è¿ç®—ã€‚
* å¯ä»¥ç»™ç±»æ·»åŠ æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå­—ç¬¦ä¸²ç±»ï¼Œå¯ä»¥æ´¾ç”Ÿå‡ºä¸€ä¸ªç±»ï¼Œå¹¶æ·»åŠ æŒ‡å®šå­—ç¬¦ä¸²æ˜¾ç¤ºé¢œè‰²çš„æ•°æ®æˆå‘˜ã€‚
* å¯ä»¥ä¿®æ”¹ç±»æ–¹æ³•çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå¯¹äºä»£è¡¨æä¾›ç»™é£æœºä¹˜å®¢çš„æœåŠ¡çš„ Passenger ç±»å¯ä»¥æ´¾ç”Ÿå‡ºæä¾›æ›´é«˜çº§åˆ«æœåŠ¡çš„FirstClassPassenger ç±»ã€‚

å½“ç„¶ï¼Œå¯ä»¥é€šè¿‡å¤åˆ¶åŸå§‹ç±»ä»£ç ï¼Œå¹¶å¯¹å…¶è¿›è¡Œä¿®æ”¹æ¥å®Œæˆä¸Šè¿°å·¥ä½œï¼Œä½†ç»§æ‰¿æœºåˆ¶åªéœ€æä¾›æ–°ç‰¹æ€§ï¼Œç”šè‡³ä¸éœ€è¦è®¿é—®æºä»£ç å°±å¯ä»¥æ´¾ç”Ÿå‡ºç±»ã€‚

### 13.1 ä¸€ä¸ªç®€å•çš„åŸºç±»

ä»ä¸€ä¸ªç±»æ´¾ç”Ÿå‡ºå¦ä¸€ä¸ªç±»æ—¶ï¼ŒåŸå§‹ç±»ç§°ä¸ºåŸºç±»ï¼Œç»§æ‰¿ç±»ç§°ä¸ºæ´¾ç”Ÿç±»ã€‚

* 1ã€åŸºç±»ï¼š

  * ä»¥Webtownä¿±ä¹éƒ¨å†³å®šè·Ÿè¸ªä¹’ä¹“çƒä¼šä¼šå‘˜ä¸ºä¾‹ï¼Œè®¾è®¡ä¸€ä¸ªç®€å•çš„ TableTennisPlayer ç±»ã€‚

  * TableTennisPlayer ç±»åªæ˜¯è®°å½•ä¼šå‘˜çš„å§“åä»¥åŠæ˜¯å¦æœ‰çƒæ¡Œã€‚

    * ```c++
      #pragma once
      // ch13_01_tabtenn0.h -- a table-tennis base class
      #ifndef CH13_01_TABTENN0_H_
      #define CH13_01_TABTENN0_H_
      #include <string>
      
      using std::string;
      // simple base class
      class TableTennisPlayer
      {
      private:
      	string firstname;
      	string lastname;
      	bool hasTable;
      public:
      	TableTennisPlayer(const string& fn = "none", const string& ln = "none", bool ht = false);
      	void Name() const;
      	bool HasTable() const { return hasTable; };
      	void ResetTable(bool v) { hasTable = v; };
      };
      #endif
      ```

    * ```c++
      // ch13_02_tabtenn0.cpp -- simple base-class method
      #include "ch13_01_tabtenn0.h"
      #include <iostream>
      
      TableTennisPlayer::TableTennisPlayer(const string & fn, 
      	const string & ln, bool ht) : firstname(fn), 
      	lastname(ln), hasTable(ht) {}
      
      void TableTennisPlayer::Name() const
      {
      	std::cout << lastname << ", " << firstname;
      }
      ```

      * å…¶ä¸­ch13_02_tabtenn0.cppä½¿ç”¨äº†ç¬¬12ç« ä»‹ç»çš„æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨è¯­æ³•ï¼Œç­‰ä»·äºä¸‹é¢å†…å®¹ï¼š

        * ```c++
          TableTennisPlayer::TableTennisPlayer(const string & fn, 
          	const string & ln, bool ht)
          {
          	firstname = fn; 
          	lastname = ln;
              hasTable = ht;
          }
          ```

        * è¯¦ç»†æ­¥éª¤æ˜¯ï¼š

          * è¿™å°†é¦–å…ˆä¸º firstname è°ƒç”¨ string çš„é»˜è®¤æ„é€ å‡½æ•°ï¼Œå†è°ƒç”¨ string çš„èµ‹å€¼è¿ç®—ç¬¦å°† firstname è®¾ç½®ä¸º fnï¼Œ
          * ä½†åˆå§‹åŒ–åˆ—è¡¨è¯­æ³•å¯å‡å°‘ä¸€ä¸ªæ­¥éª¤ï¼Œå®ƒç›´æ¥ä½¿ç”¨ string çš„å¤åˆ¶æ„é€ å‡½æ•°å°† firstname åˆå§‹åŒ–ä¸º fn

    * ```c++
      // ch13_03_usett0.cpp -- using a base class
      #include <iostream>
      #include "ch13_01_tabtenn0.h"
      
      int main(void)
      {
      	using std::cout;
      	TableTennisPlayer player1("Chuck", "Blizzard", true);
      	TableTennisPlayer player2("Tara", "Boomdea", false);
      
      	player1.Name();
      	if (player1.HasTable())
      		cout << ": has a table.\n";
      	else
      		cout << ": hasn't a table.\n";
      
      	player2.Name();
      	if (player2.HasTable())
      		cout << ": has a table.\n";
      	else
      		cout << ": hasn't a table.\n";
      
      	return 0;
      }
      ```

  * ç»“æœï¼š

    * ```c++
      Blizzard, Chuck: has a table.
      Boomdea, Tara: hasn't a table.
      ```

    * æ³¨æ„åˆ°è¯¥ç¨‹åºå®ä¾‹åŒ–å¯¹è±¡æ—¶å°† C-é£æ ¼å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼š

      * ```c++
        TableTennisPlayer player1("Chuck", "Blizzard", true);
        TableTennisPlayer player2("Tara", "Boomdea", false);
        ```

      * ä½†æ„é€ å‡½æ•°çš„å½¢å‚ç±»å‹è¢«å£°æ˜ä¸º const string &ã€‚è¿™å¯¼è‡´ç±»å‹ä¸åŒ¹é…ï¼Œä½†ä¸ç¬¬12ç« åˆ›å»ºçš„ String ç±»ä¸€æ ·ï¼Œstring ç±»æœ‰ä¸€ä¸ªå°† const char * ä½œä¸ºå‚æ•°çš„æ„é€ å‡½æ•°ï¼Œä½¿ç”¨C-é£æ ¼å­—ç¬¦ä¸²åˆå§‹åŒ– string å¯¹è±¡æ—¶ï¼Œå°†è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ„é€ å‡½æ•°ã€‚

      * æ€»ä¹‹ï¼Œ**å¯å°† string å¯¹è±¡æˆ–C-é£æ ¼å­—ç¬¦ä¸²ä½œä¸ºæ„é€ å‡½æ•° TableTennisPlayer çš„å‚æ•°**ï¼š

        * å°†å‰è€…ä½œä¸ºå‚æ•°æ—¶ï¼Œå°†è°ƒç”¨æ¥å— const string & ä½œä¸ºå‚æ•°çš„ string æ„é€ å‡½æ•°ï¼›
        * è€Œå°†åè€…ä½œä¸ºå‚æ•°æ—¶ï¼Œå°†è°ƒç”¨æ¥å— const char* ä½œä¸ºå‚æ•°çš„ string æ„é€ å‡½æ•°ã€‚

#### 13.1.1 æ´¾ç”Ÿä¸€ä¸ªç±»

Webtown ä¿±ä¹éƒ¨çš„ä¸€äº›æˆå‘˜**æ›¾ç»**å‚åŠ è¿‡å½“åœ°çš„ä¹’ä¹“çƒé”¦æ ‡èµ›ï¼šéœ€è¦è¿™æ ·ä¸€ä¸ªç±»ï¼Œå®ƒèƒ½åŒ…æ‹¬æˆå‘˜åœ¨æ¯”èµ›ä¸­çš„æ¯”åˆ†ã€‚

* ä¸å…¶ä»é›¶å¼€å§‹ï¼Œä¸å¦‚ä» TableTennisClass ç±»æ´¾ç”Ÿå‡ºä¸€ä¸ªç±»ã€‚é¦–å…ˆå°† RatedPlayer ç±»å£°æ˜ä¸ºä» TableTennisClass ç±»æ´¾ç”Ÿè€Œæ¥ï¼š

  * ```c++
    // RatedPlayer derives from the TableTennisPlayer base class
    class RatedPlayer : public TableTennisPlayer
    {
    ...
    };
    ```

  * å†’å·æŒ‡å‡º RatedPlayer ç±»çš„åŸºç±»æ˜¯ public TableTennisPlayer ç±»ã€‚

  * â€œclass RatedPlayer : public TableTennisPlayerâ€ç‰¹æ®Šçš„å£°æ˜å¤´è¡¨æ˜ TableTennisPlayer æ˜¯ä¸€ä¸ªå…¬æœ‰åŸºç±»ï¼Œè¿™è¢«ç§°ä¸ºå…¬æœ‰æ´¾ç”Ÿã€‚

    * æ´¾ç”Ÿç±»å¯¹è±¡åŒ…å«åŸºç±»å¯¹è±¡ï¼›
    * ä½¿ç”¨å…¬æœ‰æ´¾ç”Ÿï¼š
      * åŸºç±»çš„å…¬æœ‰æˆå‘˜å°†æˆä¸ºæ´¾ç”Ÿç±»çš„å…±æœ‰æˆå‘˜ï¼›
      * åŸºç±»çš„ç§æœ‰éƒ¨åˆ†ç§°ä¸ºæ´¾ç”Ÿç±»çš„ä¸€éƒ¨åˆ†ï¼Œä½†åªèƒ½é€šè¿‡åŸºç±»çš„å…¬æœ‰å’Œä¿æŠ¤æ–¹æ³•è®¿é—®ã€‚

  * RatedPlayer å¯¹è±¡å°†å…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š

    * æ´¾ç”Ÿç±»å¯¹è±¡å‚¨å­˜äº†åŸºç±»çš„æ•°æ®æˆå‘˜ï¼ˆæ´¾ç”Ÿç±»ç»§æ‰¿äº†åŸºç±»çš„å®ç°ï¼‰ï¼›
    * æ´¾ç”Ÿç±»å¯¹è±¡å¯ä»¥ä½¿ç”¨åŸºç±»çš„æ–¹æ³•ï¼ˆæ´¾ç”Ÿç±»ç»§æ‰¿äº†åŸºç±»çš„æ¥å£ï¼‰ã€‚
    * å› æ­¤ï¼ŒRatedPlayer å¯¹è±¡å¯ä»¥å‚¨å­˜è¿åŠ¨å‘˜çš„å§“ååŠå…¶æ˜¯å¦æœ‰çƒæ¡Œï¼Œå¦å¤–è¿˜å¯ä»¥ä½¿ç”¨ T ç±»çš„Name()ã€hasTable()ã€ResetTable()æ–¹æ³•ï¼š
      * ![image](https://github.com/CoderSuHang/Cpp-Primer-Plus-Notes/assets/104765251/3dc3f49a-a1a3-490d-9ed5-5ecbb3b498fe)

  * éœ€è¦å†ç»§æ‰¿ç‰¹æ€§ä¸­æ·»åŠ ä»€ä¹ˆå‘¢ï¼š

    * æ´¾ç”Ÿç±»éœ€è¦è‡ªå·±çš„æ„é€ å‡½æ•°ã€‚

    * æ´¾ç”Ÿç±»å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ é¢å¤–çš„æ•°æ®æˆå‘˜å’Œæˆå‘˜å‡½æ•°ã€‚

    * åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ´¾ç”Ÿç±»éœ€è¦å¦ä¸€ä¸ªæ•°æ®æˆå‘˜æ¥å­˜å‚¨æ¯”åˆ†ï¼Œè¿˜åº”åŒ…å«æ£€ç´¢æ¯”åˆ†çš„æ–¹æ³•å’Œé‡ç½®æ¯”åˆ†çš„æ–¹æ³•ã€‚å› æ­¤ï¼Œç±»å£°æ˜ä¸ä¸‹é¢ç±»ä¼¼ï¼š

      * ```c++
        // simple detived class
        class RatedPlayer : public TableTennisPlayer
        {
        private:
            unsigned int rating;	// add a data member
        public:
            RatedPlayer (unsigned int r = 0, const string & fn = "none", const string& ln = "none", bool ht = false);
            RatedPlayer (unsigned int r, const TableTennisPlayer & tp);
            unsigned int Rating () const { return rating; }		// add a method
            void ResetRating (unsigned int r) { rating = r; }	// add a method
        };
        ```

#### 13.1.2 æ„é€ å‡½æ•°ï¼šè®¿é—®æƒé™çš„è€ƒè™‘

ğŸ“Œæ´¾ç”Ÿç±»ä¸èƒ½ç›´æ¥è®¿é—®åŸºç±»çš„ç§æœ‰æˆå‘˜ï¼Œè€Œå¿…é¡»é€šè¿‡åŸºç±»æ–¹è¿›è¡Œè®¿é—®ã€‚å…·ä½“åœ°è¯´ï¼Œæ´¾ç”Ÿç±»æ„é€ å‡½æ•°å¿…é¡»ä½¿ç”¨åŸºç±»æ„é€ å‡½æ•°ã€‚

åˆ›å»ºæ´¾ç”Ÿå¯¹è±¡æ—¶ï¼Œç¨‹åºé¦–å…ˆåˆ›å»ºåŸºç±»å¯¹è±¡ï¼š

* ```c++
  RatedPlayer::RatedPlayer(unsigned int r, const string & fn,
                          const string & ln, bool ht) : TableTennisPlayer(fn, 
                          ln, ht)
  {
      rating = r;
  }
  ```

* å…¶ä¸­ï¼š**TableTennisPlayer (fn, ln, ht) æ˜¯æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨**ã€‚å®ƒæ˜¯å¯æ‰§è¡Œçš„ä»£ç ï¼Œè°ƒç”¨TableTennisPlayeræ„é€ å‡½æ•°ï¼š

  * ```C++
    RatedPlayer rplayer1(1140, "Mallory", "Duck", true);
    ```

    * RatedPlayeræ„é€ å‡½æ•°å°†æŠŠå®å‚ï¼ˆ"Mallory", "Duck", trueï¼‰èµ‹ç»™å½¢å‚ï¼ˆfn, ln, htï¼‰
    * ç„¶åå°†è¿™äº›å‚æ•°ä½œä¸ºå®å‚ä¼ é€’ç»™TableTennisPlayeræ„é€ å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†åˆ›å»ºä¸€ä¸ªåµŒå¥—TableTennisPlayerå¯¹è±¡ï¼Œå¹¶å°†æ•°æ®ï¼ˆ"Mallory", "Duck", trueï¼‰å­˜å‚¨åœ¨è¯¥å¯¹è±¡ä¸­ã€‚
    * æœ€åï¼Œç¨‹åºè¿›å…¥RatedPlayeræ„é€ å‡½æ•°æ„é€ å‡½æ•°ä½“ï¼Œå®ŒæˆRealPlayerå¯¹è±¡çš„åˆ›å»ºï¼Œå¹¶å°†å‚æ•°çš„ r å€¼ï¼ˆ1140ï¼‰èµ‹ç»™ratingæˆå‘˜ï¼š
      * ![image](https://github.com/CoderSuHang/Cpp-Primer-Plus-Notes/assets/104765251/24b7d846-aaf7-447f-b044-20ad6e2dc6c2)


  * å¦‚æœçœç•¥æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨ï¼Œç¨‹åºä¼šä½¿ç”¨é»˜è®¤çš„åŸºç±»æ„é€ å‡½æ•°è¿›è¡Œåˆ›å»ºåŸºç±»å¯¹è±¡ï¼Œè§P485

* å¦‚æœæ„¿æ„ï¼Œä¹Ÿå¯ä»¥å¯¹æ´¾ç”Ÿç±»æˆå‘˜ä½¿ç”¨æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨è¯­æ³•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåº”åœ¨åˆ—è¡¨ä¸­ä½¿ç”¨**æˆå‘˜å**ï¼Œè€Œä¸æ˜¯ç±»åã€‚æ‰€ä»¥ï¼Œç¬¬äºŒä¸ªæ„é€ å‡½æ•°å¯ä»¥æŒ‰ç…§ä¸‹è¿°æ–¹å¼ç¼–å†™ï¼š

  * ```c++
    // alternative version
    RatedPlayer::RatedPlayer(unsigned int r, const TableTennisPlayer & tp)
        : TableTennisPlayer(tp), rating(r)
        {
        }
    ```

* æœ‰å…³æ´¾ç”Ÿç±»æ„é€ å‡½æ•°çš„è¦ç‚¹å¦‚ä¸‹ï¼š

  * é¦–å…ˆåˆ›å»ºåŸºç±»å¯¹è±¡ï¼›
  * æ´¾ç”Ÿç±»æ„é€ å‡½æ•°åº”é€šè¿‡æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨å°†åŸºç±»ä¿¡æ¯ä¼ é€’ç»™åŸºç±»æ„é€ å‡½æ•°ï¼›
  * æ´¾ç”Ÿç±»æ„é€ å‡½æ•°åº”åˆå§‹åŒ–æ´¾ç”Ÿç±»æ–°å¢çš„æ•°æ®æˆå‘˜ã€‚

* åˆ›å»ºæ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œç¨‹åºé¦–å…ˆè°ƒç”¨åŸºç±»æ„é€ å‡½æ•°ï¼Œç„¶åå†è°ƒç”¨æ´¾ç”Ÿç±»æ„é€ å‡½æ•°ï¼š

  * åŸºç±»æ„é€ å‡½æ•°è´Ÿè´£åˆå§‹åŒ–ç»§æ‰¿çš„æ•°æ®æˆå‘˜ï¼›
  * æ´¾ç”Ÿç±»æ„é€ å‡½æ•°ä¸»è¦ç”¨äºåˆå§‹åŒ–æ–°å¢çš„æ•°æ®æˆå‘˜ã€‚
    * æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°æ€»æ˜¯è°ƒç”¨ä¸€ä¸ªåŸºç±»æ„é€ å‡½æ•°ã€‚å¯ä»¥ä½¿ç”¨åˆå§‹åŒ–å™¨åˆ—è¡¨è¯­æ³•æŒ‡æ˜è¦ä½¿ç”¨çš„åŸºç±»æ„é€ å‡½æ•°ï¼Œå¦åˆ™å°†ä½¿ç”¨é»˜è®¤çš„åŸºç±»æ„é€ å‡½æ•°ã€‚
    * æ´¾ç”Ÿç±»å¯¹è±¡è¿‡æœŸæ—¶ï¼Œç¨‹åºå°†é¦–å…ˆè°ƒç”¨æ´¾ç”Ÿç±»ææ„å‡½æ•°ï¼Œç„¶åå†è°ƒç”¨åŸºç±»ææ„å‡½æ•°ã€‚

ğŸ“Œæˆå‘˜åˆå§‹åŒ–åˆ—è¡¨ï¼š

* æ´¾ç”Ÿç±»æ„é€ å‡½æ•°å¯ä»¥ä½¿ç”¨åˆå§‹åŒ–å™¨åˆ—è¡¨æœºåˆ¶å°†å€¼ä¼ é€’ç»™åŸºç±»æ„é€ å‡½æ•°ï¼š

  * ```c++
    derived::derived(type1 x, type2 y) : base(x, y)
    {
        ...
    }
    ```

  * å…¶ä¸­ derived æ˜¯æ´¾ç”Ÿç±»ï¼Œbase æ˜¯åŸºç±»ï¼Œxå’Œyæ˜¯åŸºç±»æ„é€ å‡½æ•°ä½¿ç”¨çš„å˜é‡ã€‚

  * å¦‚æœæ²¡æœ‰åœ¨æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨ä¸­æä¾›åŸºç±»æ„é€ å‡½æ•°ï¼Œç¨‹åºå°†ä½¿ç”¨é»˜è®¤çš„åŸºç±»æ„é€ å‡½æ•°ã€‚æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨åªèƒ½ç”¨äºæ„é€ å‡½æ•°ã€‚



#### 13.1.3 ä½¿ç”¨æ´¾ç”Ÿç±»

è¦ä½¿ç”¨æ´¾ç”Ÿç±»ï¼Œç¨‹åºå¿…é¡»è¦**èƒ½å¤Ÿè®¿é—®åŸºç±»å£°æ˜**ã€‚ç¨‹åºæ¸…å• 13.4 å°†è¿™**ä¸¤ç§ç±»**çš„**å£°æ˜**ç½®äº**åŒä¸€ä¸ªå¤´æ–‡ä»¶**ä¸­ã€‚ä¹Ÿå¯ä»¥å°†æ¯ä¸ªç±»æ”¾åœ¨ç‹¬ç«‹çš„å¤´æ–‡ä»¶ä¸­ï¼Œä½†ç”±äºè¿™ä¸¤ä¸ªç±»æ˜¯ç›¸å…³çš„ï¼Œæ‰€ä»¥æŠŠå…¶ç±»å£°æ˜æ”¾åœ¨ä¸€èµ·æ›´åˆé€‚ã€‚

* ç¤ºä¾‹ï¼š

  * ```c++
    #pragma once
    // ch13_04_tabtenn1.h -- a table-tennis base class
    #ifndef CH13_04_TABTENN1_H_
    #define CH13_04_TABTENN1_H_
    #include<string>
    using std::string;
    // simple base class
    class TableTennisPlayer
    {
    private:
    	string firstname;
    	string lastname;
    	bool hasTable;
    public:
    	TableTennisPlayer(const string& fn = "none",
    					  const string& ln = "none", bool ht = false);
    	void Name() const;
    	bool HasTable() const { return hasTable; };
    	void ResetTable(bool v) { hasTable = v; };
    };
    
    // simple derived class
    class RatedPlayer : public TableTennisPlayer
    {
    private:
    	unsigned int rating;
    public:
    	RatedPlayer(unsigned int r = 0, const string& fn = "none",
    				const string& ln = "none", bool ht = false);
    	RatedPlayer(unsigned int r, const TableTennisPlayer& tp);
    	unsigned int Rating() const { return rating; }
    	void ResetRating(unsigned int r) { rating = r; }
    };
    #endif
    ```

  * ```c++
    // ch13_05_tabtenn1.cpp -- simple base-class methods
    #include "ch13_04_tabtenn1.h"
    #include <iostream>
    
    TableTennisPlayer::TableTennisPlayer (const string & fn,
    	const string & ln, bool ht) : firstname(fn),
    	lastname(ln), hasTable(ht) {}
    
    void TableTennisPlayer::Name() const
    {
    	std::cout << lastname << ", " << firstname;
    }
    
    // RatedPlayer methods
    RatedPlayer::RatedPlayer (unsigned int r, const string& fn,
    	const string& ln, bool ht) : TableTennisPlayer(fn, ln, ht)
    {
    	rating = r;
    }
    
    RatedPlayer::RatedPlayer(unsigned int r, const TableTennisPlayer& tp)
    	: TableTennisPlayer(tp), rating(r)
    {
    }
    ```

  * ```c++
    // ch13_06_usett1.cpp -- using base class and derived class
    #include <iostream>
    #include "ch13_04_tabtenn1.h"
    
    int main(void)
    {
    	using std::cout;
    	using std::endl;
    	TableTennisPlayer player1("Tara", "Boomdea", false);
    	RatedPlayer rplayer1(1140, "Mallory", "Duck", true);
    	rplayer1.Name();
    	if (rplayer1.HasTable())
    		cout << ": has a table.\n";
    	else
    		cout << ": hasn't a table.\n";
    	player1.Name();
    	if (player1.HasTable())
    		cout << ": has a table\n";
    	else
    		cout << ": hasn't a table.\n";
    	cout << "Name: ";
    	rplayer1.Name();
    	cout << "; Rating: " << rplayer1.Rating() << endl;
    	RatedPlayer rplayer2(1212, player1);
    	cout << "Name: ";
    	rplayer2.Name();
    	cout << "; Rating: " << rplayer2.Rating() << endl;
    
    	return 0;
    }
    ```

* ç»“æœï¼š

  * ```c++
    Duck, Mallory: has a table.
    Boomdea, Tara: hasn't a table.
    Name: Duck, Mallory; Rating: 1140
    Name: Boomdea, Tara; Rating: 1212
    ```



#### 13.1.4 æ´¾ç”Ÿç±»å’ŒåŸºç±»ä¹‹é—´çš„ç‰¹æ®Šå…³ç³»

ï¼ˆ1ï¼‰æ´¾ç”Ÿç±»å¯¹è±¡å¯ä»¥ä½¿ç”¨åŸºç±»çš„æ–¹æ³•ï¼Œæ¡ä»¶æ˜¯æ–¹æ³•ä¸æ˜¯ç§æœ‰çš„ï¼›

* ```c++
  RatedPlayer rplayer1(1140, "Mallory", "Duck", true);
  rplayer1.Name();
  ```

ï¼ˆ2ï¼‰åŸºç±»æŒ‡é’ˆå¯ä»¥åœ¨ä¸è¿›è¡Œæ˜¾å¼ç±»å‹è½¬æ¢çš„æƒ…å†µä¸‹æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡ï¼›

* ```c++
  RatedPlayer rplayer1(1140, "Mallory", "Duck", true);
  TableTennisPlayer * pt = &rplayer;
  py->Name();
  ```

ï¼ˆ3ï¼‰åŸºç±»åº”ç”¨å¯ä»¥åœ¨ä¸è¿›è¡Œæ˜¾å¼ç±»å‹è½¬æ¢çš„æƒ…å†µä¸‹å¼•ç”¨æ´¾ç”Ÿç±»å¯¹è±¡/

* ```c++
  RatedPlayer rplayer1(1140, "Mallory", "Duck", true);
  TableTennisPlayer & rt = rplayer;
  rt.Name();
  ```

â—åŸºç±»**æŒ‡é’ˆ**æˆ–**å¼•ç”¨**åªèƒ½è°ƒç”¨åŸºç±»æ–¹æ³•ï¼Œå› æ­¤ï¼Œä¸èƒ½ä½¿ç”¨rtæˆ–ptæ¥è°ƒç”¨æ´¾ç”Ÿç±»çš„ResetRankingæ–¹æ³•ã€‚

â—å¯ä»¥å°†æ´¾ç”Ÿç±»å¯¹è±¡å’Œåœ°å€èµ‹ç»™åŸºç±»åº”ç”¨å’ŒæŒ‡é’ˆã€‚ï¼ˆåŒ…å«å…³ç³»ï¼‰

* é€šå¸¸ï¼ŒC++è¦æ±‚å¼•ç”¨å’ŒæŒ‡é’ˆç±»å‹ä¸èµ‹ç»™çš„ç±»å‹åŒ¹é…ï¼Œä½†è¿™ä¸€è§„åˆ™å¯¹**ç»§æ‰¿**æ¥è¯´æ˜¯ä¾‹å¤–ã€‚ç„¶è€Œï¼Œè¿™ç§ä¾‹å¤–åªæ˜¯å•å‘çš„ï¼Œä¸å¯ä»¥å°†åŸºç±»å¯¹è±¡å’Œåœ°å€èµ‹ç»™æ´¾ç”Ÿç±»å¼•ç”¨å’ŒæŒ‡é’ˆã€‚
* ä»£ç è§P488ï¼Œè¿™ä¸€éƒ¨åˆ†å¾ˆæ·±å¥¥ï¼Œåœ¨åç»­åº”ç”¨è¿‡ç¨‹ä¸­å¯ä»¥åå¤ç¿»é˜…æŸ¥çœ‹



### 13.2 ç»§æ‰¿ï¼šis-aå…³ç³»

æ´¾ç”Ÿç±»å’ŒåŸºç±»ä¹‹é—´çš„ç‰¹æ®Šå…³ç³»æ˜¯åŸºäºC++ç»§æ‰¿çš„åº•å±‚æ¨¡å‹ã€‚å®é™…ä¸ŠC++æœ‰3ç§ç»§æ‰¿æ–¹å¼ï¼šï¼ˆå…¬æœ‰ç»§æ‰¿ã€ä¿æŠ¤ç»§æ‰¿ã€ç§æœ‰ç»§æ‰¿ï¼‰

* å…¬æœ‰ç»§æ‰¿ï¼š
  * is-aå…³ç³»ï¼Œå³æ´¾ç”Ÿç±»å¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªåŸºç±»å¯¹è±¡ï¼Œå¯ä»¥å¯¹åŸºç±»å¯¹è±¡æ‰§è¡Œçš„ä»»ä½•æ“ä½œï¼Œä¹Ÿå¯ä»¥å¯¹æ´¾ç”Ÿç±»å¯¹è±¡æ‰§è¡Œã€‚
    * ä¸è¯¥æ¨¡å‹ä¸ç¬¦çš„ä¾‹å­ï¼šP490
      * has-aå…³ç³»
      * is-like-aå…³ç³»
      * is-implemented-as-aå…³ç³»
      * use-aå…³ç³»



### 13.3 å¤šæ€å…¬æœ‰ç»§æ‰¿

å¤šæ€ï¼šå…·æœ‰å¤šç§å½¢æ€çš„å¤æ‚è¡Œä¸ºï¼Œå³æ–¹æ³•çš„è¡Œä¸ºåº”å–å†³äºè°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡ã€‚

* ä¹‹å‰è®²è¿°çš„ç»§æ‰¿å¾ˆç®€å•ï¼Œæ´¾ç”Ÿç±»å¯¹è±¡ä½¿ç”¨åŸºç±»çš„æ–¹æ³•ï¼Œè€Œæœªåšä»»ä½•æ”¹å˜ã€‚ç„¶è€Œï¼Œå¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œå³å¸Œæœ›åŒä¸€ä¸ªæ–¹æ³•åœ¨æ´¾ç”Ÿç±»çš„å’ŒåŸºç±»ç§çš„è¡Œä¸ºæ˜¯ä¸åŒçš„ã€‚

ç”¨äºå®ç°å¤šæ€å…¬æœ‰ç»§æ‰¿çš„ä¸¤ç§é‡è¦æœºåˆ¶ï¼š

* åœ¨æ´¾ç”Ÿç±»ç§é‡æ–°å®šä¹‰åŸºç±»çš„æ–¹æ³•ï¼›
* ä½¿ç”¨è™šæ–¹æ³•ã€‚

ç¤ºä¾‹ï¼šåˆ›å»ºä¸¤ä¸ªç±»

* 1ã€ç”¨äºè¡¨ç¤ºåŸºæœ¬æ”¯ç¥¨è´¦æˆ·â€”â€”Brass Account
* 2ã€è°ƒä»·äº†é€æ”¯ä¿æŠ¤æ€§çš„æ”¯ç¥¨ä¿æŠ¤â€”â€”Brass Plus

ä»Brasså…¬æœ‰ç±»æ´¾ç”Ÿå‡ºBrassPlusï¼Œå¹¶ä¸”BrassPlusç±»æ»¡è¶³is-aæ¡ä»¶ï¼ˆis-aå…³ç³»é€šå¸¸ä¸å¯é€†ï¼šæ°´æœä¸æ˜¯é¦™è•‰ï¼ŒåŒæ ·ï¼ŒBrasså¯¹è±¡ä¸å…·å¤‡BrassPluså¯¹è±¡çš„æ‰€æœ‰åŠŸèƒ½ã€‚

#### 13.3.1 å¼€å‘Brassç±»å’ŒBrassPlusç±»

è§P491

* ç¤ºä¾‹ï¼š

  * ```c++
    //ch13_07_brass.h -- bank account classes
    #ifndef CH13_07_BRASS_H_
    #define CH13_07_BRASS_H_
    #include <iostream>
    // Brass Account Class
    class Brass
    {
    private:
    	std::string fullName;
    	long acctNum;
    	double balance;
    public:
    	Brass(const std::string& s = "Nullbody", long an = -1,
    		double bal = 0.0);
    	void Deposit(double amt);
    	virtual void Withdraw(double amt);
    	double Balance() const;
    	virtual void ViewAcct() const;
    	virtual ~Brass() {}
    };
    
    // Brass Plus Account Class
    class BrassPlus : public Brass
    {
    private:
    	double maxLoan;
    	double rate;
    	double owesBank;
    public:
    	BrassPlus(const std::string& s = "Nullbody", long an = -1,
    		double bal = 0.0, double ml = 500,
    		double r = 0.11125);
    	BrassPlus(const Brass & ba, double ml = 500,
    		double r = 0.11125);
    	virtual void ViewAcct() const;
    	virtual void Withdraw(double amt);
    	void ResetMax(double m) { maxLoan = m; }
    	void ResetRate(double r) { rate = r; }
    	void ResetOwes() { owesBank = 0; }
    };
    
    #endif
    ```

    * BrassPlus ç±»åœ¨ Brass ç±»çš„åŸºç¡€ä¸Šæ·»åŠ äº†3ä¸ªæœ‰æ•°æ®æˆå‘˜å’Œ3å…¬æœ‰æˆå‘˜å‡½æ•°ï¼›
    * Brass ç±»å’Œ BrassPlus ç±»éƒ½å£°æ˜äº† ViewAcct() å’Œ Withdraw() æ–¹æ³•, BrassPlus å¯¹è±¡å’Œ Brass å¯¹è±¡çš„è¿™äº›æ–¹æ³•çš„è¡Œä¸ºæ˜¯ä¸åŒçš„ï¼›
    * Brass ç±»åœ¨å£°æ˜ ViewAcct() å’Œ Withdraw() æ—¶ä½¿ç”¨äº†æ–°å…³é”®å­— **virtual**ã€‚è¿™äº›æ–¹æ³•è¢«ç§°ä¸º**è™šæ–¹æ³•(virtualmethod)**ï¼›è§P493
      * å¦‚æœæ–¹æ³•æ˜¯é€šè¿‡å¼•ç”¨æˆ–æŒ‡é’ˆè€Œä¸æ˜¯å¯¹è±¡è°ƒç”¨çš„ï¼Œå®ƒå°†ç¡®å®šä½¿ç”¨å“ªä¸€ç§æ–¹æ³•ã€‚
      * å¦‚æœæ²¡æœ‰ä½¿ç”¨å…³é”®å­— virtualï¼Œç¨‹åºå°†æ ¹æ®å¼•ç”¨ç±»å‹æˆ–æŒ‡é’ˆç±»å‹é€‰æ‹©æ–¹æ³•ï¼›
      * å¦‚æœä½¿ç”¨äº†virtualï¼Œç¨‹åºå°†æ ¹æ®å¼•ç”¨æˆ–æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡çš„ç±»å‹æ¥é€‰æ‹©æ–¹æ³•ã€‚
      * ![image-20231227180043808](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20231227180043808.png)
    * Brass ç±»è¿˜å£°æ˜äº†ä¸€ä¸ªè™šææ„å‡½æ•°ï¼Œè™½ç„¶è¯¥ææ„å‡½æ•°ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚
      * åŸºç±»å£°æ˜äº†ä¸€ä¸ªè™šææ„å‡½æ•°ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†ç¡®ä¿é‡Šæ”¾æ´¾ç”Ÿå¯¹è±¡æ—¶ï¼ŒæŒ‰æ­£ç¡®çš„é¡ºåºè°ƒç”¨ææ„å‡½æ•°ã€‚

  * ğŸ“Œå¦‚æœè¦åœ¨**æ´¾ç”Ÿç±»**ä¸­é‡**æ–°å®šä¹‰åŸºç±»**çš„æ–¹æ³•ï¼Œé€šå¸¸åº”**å°†åŸºç±»æ–¹æ³•å£°æ˜ä¸ºè™šçš„**ã€‚è¿™æ ·ï¼Œç¨‹åºå°†æ ¹æ®å¯¹è±¡ç±»å‹è€Œä¸æ˜¯å¼•ç”¨æˆ–æŒ‡é’ˆçš„ç±»å‹æ¥é€‰æ‹©æ–¹æ³•ç‰ˆæœ¬ã€‚ä¸ºåŸºç±»å£°æ˜ä¸€ä¸ªè™šææ„å‡½æ•°ä¹Ÿæ˜¯ä¸€ç§æƒ¯ä¾‹ã€‚

**1ã€ç±»å®ç°**

* ç¤ºä¾‹ï¼š

  * ```c++
    // ch13_08_brass.cpp -- bank account class methods
    #include <iostream>
    #include "ch13_07_brass.h"
    using std::cout;
    using std::endl;
    using std::string;
    
    // formatting stuff
    typedef std::ios_base::fmtflags format;
    typedef std::streamsize precis;
    format setFormat();
    void restore(format f, precis p);
    
    // Brass methods
    
    Brass::Brass(const string& s, long an, double bal)
    {
    	fullName = s;
    	acctNum = an;
    	balance = bal;
    }
    
    void Brass::Deposit(double amt)
    {
    	if (amt < 0)
    		cout << "Negative deposit not allowed; "
    		<< "deposit is cancelled.\n";
    	else
    		balance += amt;
    }
    
    void Brass::Withdraw(double amt)
    {
    	// set up ###.## format
    	format initialState = setFormat();
    	precis prec = cout.precision(2);
    
    	if (amt < 0)
    		cout << "Withdrawal amount must be positive;"
    		<< "withdrawal canceled.\n";
    	else if (amt <= balance)
    		balance -= amt;
    	else
    		cout << "Withdrawal amount of $" << amt
    			 << " exceeds your balance.\n"
    			 << "Withdrawal canceled.\n";
    	restore(initialState, prec);
    }
    
    double Brass::Balance() const
    {
    	return balance;
    }
    
    void Brass::ViewAcct() const
    {
    	// set up ###.## format
    	format initialState = setFormat();
    	precis prec = cout.precision(2);
    	cout << "Client: " << fullName << endl;
    	cout << "Account Number: " << acctNum << endl;
    	cout << "Balance: $" << balance << endl;
    	restore(initialState, prec);
    }
    
    // BrassPlus Methods
    BrassPlus::BrassPlus(const string& s, long an, double bal,
    	double ml, double r) : Brass(s, an, bal)
    {
    	maxLoan = ml;
    	owesBank = 0.0;
    	rate = r;
    }
    
    BrassPlus::BrassPlus(const Brass& ba, double ml, double r)
    	: Brass(ba)	// use implicit copy constructor
    {
    	maxLoan = ml;
    	owesBank = 0.0;
    	rate = r;
    }
    
    // redefine how ViewAcct() works
    void BrassPlus::ViewAcct() const
    {
    	// set up ###.## format
    	format initialState = setFormat();
    	precis prec = cout.precision(2);
    
    	Brass::ViewAcct();
    	cout << "Maximum loan: $" << maxLoan << endl;
    	cout << "Owed to bank: $" << oweBank << endl;
    	cout.precision(3);
    	cout << "Loan Rate: " << 100 * rate << "&\n";
    	restore(initialState, prec);
    }
    
    // redefine how Withdraw() works
    void BrassPlus::Withdraw(double amt)
    {
    	// set up ###.## format
    	format initialState = setFormat();
    	precis prec = cout.precision(2);
    
    	double bal = Balance();
    	if (amt <= bal)
    		Brass::Withdraw(amt);
    	else if (amt <= bal + maxLoan - owesBank)
    	{
    		double advance = amt - bal;
    		owesBank += advance * (1.0 + rate);
    		cout << "Bank advance: $" << advance << endl;
    		cout << "Finance charge: $" << advance * rate << endl;
    		Deposit(advance);
    		Brass::Withdraw(amt);
    	}
    	else
    		cout << "Credit limit exceeded. Transaction cancelled.\n";
    	restore(initialState, prec);
    }
    
    format setFormat()
    {
    	// set up ###.## format
    	return cout.setf(std::ios_base::fixed,
    		std::ios_base::floatfield);
    }
    
    void restore(format f, precis p)
    {
    	cout.setf(f, std::ios_base::floatfield);
    	cout.precision(p);
    }
    ```

    * æ´¾ç”Ÿç±»å¹¶ä¸èƒ½ç›´æ¥è®¿é—®åŸºç±»çš„ç§æœ‰æ•°æ®ï¼Œè€Œå¿…é¡»ä½¿ç”¨åŸºç±»çš„å…¬æœ‰æ–¹æ³•æ‰èƒ½è®¿é—®è¿™äº›æ•°æ®ã€‚
      * æ´¾ç”Ÿç±»æ„é€ å‡½æ•°åœ¨åˆå§‹åŒ–åŸºç±»ç§æœ‰æ•°æ®æ—¶ï¼Œé‡‡ç”¨çš„æ˜¯**æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨**è¯­æ³•ã€‚RatedPlayer ç±»æ„é€ å‡½æ•°å’ŒBrassPlusæ„é€ å‡½æ•°éƒ½ä½¿ç”¨è¿™ç§æŠ€æœ¯ã€‚P496
        * å°†åŸºç±»ä¿¡æ¯ä¼ é€’ç»™åŸºç±»æ„é€ å‡½æ•°ï¼Œç„¶åä½¿ç”¨æ„é€ å‡½æ•°ä½“åˆå§‹åŒ–BrassPlusç±»æ–°å¢çš„æ•°æ®é¡¹ã€‚
      * éæ„é€ å‡½æ•°ä¸èƒ½ä½¿ç”¨æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨è¯­æ³•ï¼Œä½†æ´¾ç”Ÿç±»æ–¹æ³•å¯ä»¥è°ƒç”¨å…¬æœ‰çš„åŸºç±»æ–¹æ³•ã€‚P496
        * åœ¨æ´¾ç”Ÿç±»æ–¹æ³•ä¸­ï¼Œæ ‡å‡†æŠ€æœ¯æ˜¯ä½¿ç”¨ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦æ¥è°ƒç”¨åŸºç±»æ–¹æ³•ã€‚
        * å¦‚æœæ´¾ç”Ÿç±»æ²¡æœ‰é‡æ–°å®šä¹‰è¯¥æ–¹æ³•ï¼Œä»£ç ä¸å¿…å¯¹å‡½æ•°ä½¿ç”¨ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ã€‚
      * æ–¹æ³• ViewAcct() å’Œ Withdraw() ä½¿ç”¨æ ¼å¼åŒ–æ–¹æ³• setf() å’Œ precision() å°†ç‚¹å€¼çš„è¾“å‡ºæ¨¡å¼è®¾ç½®ä¸ºå®šç‚¹ï¼Œå³åŒ…å«ä¸¤ä½å°æ•°ã€‚è®¾ç½®æ¨¡å¼åï¼Œè¾“å‡ºçš„æ¨¡å¼å°†ä¿æŒä¸å˜ï¼Œå› æ­¤è¯¥æ–¹æ³•å°†æ ¼å¼æ¨¡å¼é‡ç½®ä¸ºè°ƒç”¨å‰çš„çŠ¶æ€ã€‚
      * å‡½æ•° setFormat() è®¾ç½®å®šç‚¹è¡¨ç¤ºæ³•å¹¶è¿”å›ä»¥å‰çš„æ ‡è®°è®¾ç½®ï¼›
      * è€Œå‡½æ•°restore()é‡ç½®æ ¼å¼å’Œç²¾åº¦ã€‚

**2ã€ä½¿ç”¨ Brass å’Œ BrassPlus ç±»**

* ç¤ºä¾‹ï¼š

  * ```c++
    // ch13_09_usebrass1.cpp -- testing bank account classes
    // compile with ch13_09_usebrass1.cpp
    #include <iostream>
    #include "ch13_07_brass.h"
    
    int main()
    {
    	using std::cout;
    	using std::endl;
    
    	Brass Piggy("Porcelot Pigg", 381299, 4000.00);
    	BrassPlus Hoggy("Horatia Hogg", 382288, 3000.00);
    	Piggy.ViewAcct();
    	cout << endl;
    	Hoggy.ViewAcct();
    	cout << endl;
    	cout << "Depositing $1000 into the Hogg Account:\n";
    	Hoggy.Deposit(1000.00);
    	cout << "New balance: $" << Hoggy.Balance() << endl;
    	cout << "Withdrawing $4200 from the Pigg Account:\n";
    	Piggy.Withdraw(4200.00);
    	cout << "Pigg account balance: $" << Piggy.Balance() << endl;
    	cout << "Withdrawing $4200 from the Hogg Account:\n";
    	Hoggy.Withdraw(4200.00);
    	Hoggy.ViewAcct();
    
    	return 0;
    }
    ```

* ç»“æœï¼š

  * ```c++
    Client: Porcelot Pigg
    Account Number: 381299
    Balance: $4000.00
    
    Client: Horatia Hogg
    Account Number: 382288
    Balance: $3000.00
    Maximum loan: $500.00
    Owed to bank: $0.00
    Loan Rate: 11.125%
    
    Depositing $1000 into the Hogg Account:
    New balance: $4000
    Withdrawing $4200 from the Pigg Account:
    Withdrawal amount of $4200.00 exceeds your balance.
    Withdrawal canceled.
    Pigg account balance: $4000
    Withdrawing $4200 from the Hogg Account:
    Bank advance: $200.00
    Finance charge: $22.25
    Client: Horatia Hogg
    Account Number: 382288
    Balance: $0.00
    Maximum loan: $500.00
    Owed to bank: $222.25
    Loan Rate: 11.125%
    ```

**3ã€æ¼”ç¤ºè™šæ–¹æ³•çš„è¡Œä¸º**

ch13_09_usebrass1.cppç¨‹åºæ¸…å•ä¸­ï¼Œæ–¹æ³•æ˜¯é€šè¿‡å¯¹è±¡ï¼ˆè€Œä¸æ˜¯æŒ‡é’ˆæˆ–å¼•ç”¨ï¼‰è°ƒç”¨çš„ï¼Œæ²¡æœ‰ä½¿ç”¨è™šæ–¹æ³•ç‰¹æ€§ï¼Œä¸‹é¢æ¥ä½¿ç”¨è™šæ–¹æ³•ï¼š

* åˆ›å»ºæŒ‡å‘Brassçš„æŒ‡é’ˆæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ çš„ç±»å‹éƒ½ç›¸åŒï¼Œä½†ç”±äºä½¿ç”¨çš„æ˜¯å…¬æœ‰ç»§æ‰¿æ¨¡å‹ï¼Œå› æ­¤BrassæŒ‡é’ˆæ—¢å¯ä»¥æŒ‡å‘Brasså¯¹è±¡ä¹Ÿå¯ä»¥æŒ‡å‘BrassPluså¯¹è±¡ã€‚

* å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ•°ç»„æ¥è¡¨ç¤ºå¤šç§ç±»å‹çš„å¯¹è±¡ï¼Œè¿™å°±æ˜¯å¤šæ€æ€§ã€‚

* ç¤ºä¾‹ï¼š

  * ```c++
    // ch13_10_usebrass2.cpp -- polymorphic example
    // compile with ch13_08_brass.cpp
    #include <iostream>
    #include <string>
    #include "ch13_07_brass.h"
    
    const int CLIENTS = 4;
    
    int main()
    {
    	using std::cin;
    	using std::cout;
    	using std::endl;
    
    	Brass* p_clients[CLIENTS];
    	std::string temp;
    	long tempnum;
    	double tempbal;
    	char kind;
    
    	for (int i = 0; i < CLIENTS; i++)
    	{
    		cout << "Enter client's name: ";
    		getline(cin, temp);
    		cout << "Enter client's account number: ";
    		cin >> tempnum;
    		cout << "Enter opening balance: $";
    		cin >> tempbal;
    		cout << "Enter 1 for Brass Account or "
    			<< "2 for BrassPlus Account: ";
    		while (cin >> kind && (kind != '1' && kind != '2'))
    			cout << "Enter either 1 or 2: ";
    		if (kind == '1')
    			p_clients[i] = new Brass(temp, tempnum, tempbal);
    		else
    		{
    			double tmax, trate;
    			cout << "Enter the overdraft limit: $";
    			cin >> tmax;
    			cout << "Enter the interest rate "
    				<< "as a decimal fraction: ";
    			cin >> trate;
    			p_clients[i] = new BrassPlus(temp, tempnum, tempbal,
    										 tmax, trate);
    		}
    		while (cin.get() != '\n')
    			continue;
    	}
    	cout << endl;
    	for (int i = 0; i < CLIENTS; i++)
    	{
    		p_clients[i]->ViewAcct();
    		// å¦‚æœæ•°ç»„æˆå‘˜æŒ‡å‘çš„æ˜¯ Brass å¯¹è±¡ï¼Œåˆ™è°ƒç”¨ Brass::ViewAcct();
    		// å¦‚æœæ•°ç»„æˆå‘˜æŒ‡å‘çš„æ˜¯ BrassPlus å¯¹è±¡ï¼Œåˆ™è°ƒç”¨ BrassPlus::ViewAcct();
    		// å¦‚æœ Brass::ViewAcct() è¢«å£°æ˜ä¸ºè™šçš„ï¼Œåˆ™åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½å°†è°ƒç”¨ Brass::ViewAcct()ã€‚
    		cout << endl;
    	}
    
    	for (int i = 0; i < CLIENTS; i++)
    	{
    		delete p_clients[i];
    	}
    	cout << "Done.\n";
    	return 0;
    }
    ```

    * ![image-20231228160440479](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20231228160440479.png)
      * æŠ¥é”™åŸå› ï¼šä¸¤ä¸ªforå¾ªç¯åµŒå¥—åœ¨äº†ç¬¬ä¸€ä¸ªforå¾ªç¯ä¸­ï¼Œç¨‹åºå´©æºƒã€‚

* ç»“æœï¼š

  * ```c++
    Enter client's name: Harry Fishsong
    Enter client's account number: 112233
    Enter opening balance: $1500
    Enter 1 for Brass Account or 2 for BrassPlus Account: 1
    Enter client's name: Dinah Otternoe
    Enter client's account number: 121213
    Enter opening balance: $1800
    Enter 1 for Brass Account or 2 for BrassPlus Account: 2
    Enter the overdraft limit: $350
    Enter the interest rate as a decimal fraction: 0.12
    Enter client's name: Brenda Birdherd
    Enter client's account number: 212118
    Enter opening balance: $5200
    Enter 1 for Brass Account or 2 for BrassPlus Account: 2
    Enter the overdraft limit: $800
    Enter the interest rate as a decimal fraction: 0.10
    Enter client's name: Tim Turtletop
    Enter client's account number: 233255
    Enter opening balance: $688
    Enter 1 for Brass Account or 2 for BrassPlus Account: 1
    
    Client: Harry Fishsong
    Account Number: 112233
    Balance: $1500.00
    
    Client: Dinah Otternoe
    Account Number: 121213
    Balance: $1800.00
    Maximum loan: $350.00
    Owed to bank: $0.00
    Loan Rate: 12.000%
    
    Client: Brenda Birdherd
    Account Number: 212118
    Balance: $5200.00
    Maximum loan: $800.00
    Owed to bank: $0.00
    Loan Rate: 10.000%
    
    Client: Tim Turtletop
    Account Number: 233255
    Balance: $688.00
    
    Done.
    ```



**4ã€ä¸ºä½•éœ€è¦ææ„å‡½æ•°**

åœ¨ä¸Šè¿°ç¨‹åºæ¸…å•ä¸­ï¼Œä½¿ç”¨ delete é‡Šæ”¾ç”± new åˆ†é…çš„å¯¹è±¡ä»£ç è¯´æ˜äº†ä¸ºä½•åŸºç±»åº”åŒ…å«ä¸€ä¸ªè™šææ„å‡½æ•°ï¼š

* å¦‚æœææ„å‡½æ•°ä¸æ˜¯è™šçš„ï¼Œåˆ™å°†åªè°ƒç”¨å¯¹åº”äºæŒ‡é’ˆç±»å‹çš„ææ„å‡½æ•°ã€‚å¯¹äºç¨‹åºæ¸…å•13.10è¿™æ„å‘³ç€åªæœ‰ Brass çš„ææ„å‡½æ•°è¢«è°ƒç”¨ï¼Œå³ä½¿æŒ‡é’ˆæŒ‡çš„æ˜¯ä¸€ä¸ª BrassPluså¯¹è±¡ã€‚
* å¦‚æœææ„æ•°æ˜¯è™šçš„ï¼Œå°†è°ƒç”¨ç›¸åº”å¯¹è±¡ç±»å‹çš„ææ„å‡½æ•°ã€‚
* å› æ­¤ï¼Œå¦‚æœæŒ‡é’ˆæŒ‡çš„æ˜¯ BrassPlus å¯¹è±¡ï¼Œå°†è°ƒç”¨ BrassPlus çš„ææ„å‡½æ•°ï¼Œç„¶åè‡ªåŠ¨è°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°ã€‚

å› æ­¤ï¼Œä½¿ç”¨è™šææ„å‡½æ•°å¯ä»¥ç¡®ä¿æ­£ç¡®çš„ææ„å‡½æ•°åºåˆ—è¢«è°ƒç”¨ã€‚

å¯¹äºç¨‹åºæ¸…å• 13.10ï¼Œè¿™ç§æ­£ç¡®çš„è¡Œä¸ºå¹¶ä¸æ˜¯å¾ˆé‡è¦ï¼Œå› ä¸ºææ„å‡½æ•°æ²¡æœ‰æ‰§è¡Œä»»ä½•æ“ä½œã€‚ç„¶è€Œï¼Œå¦‚æœ BrassPlus åŒ…å«ä¸€ä¸ªæ‰§è¡ŒæŸäº›æ“ä½œçš„ææ„å‡½æ•°ï¼Œåˆ™ Brass å¿…é¡»æœ‰ä¸€ä¸ªè™šææ„å‡½æ•°ï¼Œå³ä½¿è¯¥ææ„å‡½æ•°ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚



### 13.4 é™æ€è”ç¼–å’ŒåŠ¨æ€è”ç¼–



